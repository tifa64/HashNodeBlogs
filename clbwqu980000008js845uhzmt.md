---
title: "ุงุฒุงู ุชุนูู System design ู Facebook messenger"
datePublished: Tue Dec 20 2022 21:34:10 GMT+0000 (Coordinated Universal Time)
cuid: clbwqu980000008js845uhzmt
slug: techcapsule-in-arabic-system-design-fb-messenger
tags: system-design, arabic

---

โซ ุนูููุง ุจ (ุงุดุฑุญ ุงูุญุงุฌุฉ ุนุดุงู ุชููููุง) ู ุฏู ุซุฑูุฏ ุจ ุงุฒุงู ุชุนูู System design ู Facebook messenger

โซ ูู ุงูุจุฏุงูุฉ ุจูุญุฏุฏ ุงูู ูู ุงูrequirements

โซ ูก- ุงููุณุชุฎุฏููู ููุฏุฑูุง ูุจุนุชูุง ุฑุณุงูู ูุจุนุถ.

โซ ูข- ููุฏุฑ ูุดูู ุงูonline/offline status

โซ ูฃ- ุงูุชุดุงุช ูุจูู ููุฌูุฏ ู ูุชุฎุฒู ู ุฏุงุชุงุจูุฒ ููุงุจุฏ

โซ ูค- ุงูุฑุณุงูู ุชุจูู up to date ุนูุฏ ุงููุณุชุฎุฏููู ู ุงูุฏุงุชุง ุชุจูู consistent

โซ ูฅ- ููุจูุงุด ููู delay ุนุดุงู ุงูุฑุณุงูุฉ ุชูุตู ููุทุฑู ุงูุชุงูู

โซ ูฆ- ุงููุงุณูุฌุฑ ูุจูู ูุชุงุญ ููู ุญุงุจุจ ู access it ุจุณ ุงูุฃูู ุงู ุงูุชุดุงุช ูุจูู consistent ูุนูู ููุชุบูุฑุด .. ู ุจููุถู ุงูconsistency ุนู ุงูavailability ู ุงูุญุงูุฉ ุฏู ุจุนุฏูู ุจูุนูู ุญุงุฌุฉ ุงุณููุง Back of the envelope calculations ู ูู ูุฌุฑุฏ estimations ุนู ุงูtraffic ุงููู ุงูservice ุญุชุฎุฏู ุนูููุง ุนุดุงู ุชุนุฑู ุงูstorage ุงููุทููุจ ู ุงูbandwidth

โซ ุฏูููุชู ููุณุจูู ุนูุฏู ุจูููู ูุณุชุนูู .. ูููู ุงู ูุตูู ุนุงููุงุณูุฌุฑ ููููุง .. ู ูู ูุณุชุฎุฏู ูู ุฏูู ุจูุจุนุช ูฅู ุฑุณุงูุฉ ูููููุง .. 500 million users \* 50 messages = 25,000,000,000 messages

โซ ูู ูููุง ุงู ุญุฌู ุงูุฑุณุงูุฉ ุงููุงุญุฏุฉ ุจ 100 bytes ูุจูู ุงุฌูุงูู ุงูstorage ูุนูู ุงุฌูุงูู ุงูุญุฌู ุจุงูbytes

\= 2500,000,000,000 2.5 Terabyte

โซ ูู ุงูุชุฑุถูุง ุงููุง ุญูุฌุฑุจ ุงูapp ููุฏุฉ ูฅ ุณููู 5 \* 12 \* 365 = 21900 ูุญุงูู ููุฑุจูุง ู 22000 ุนุดุงู ูุณูููุง ุนูู ููุณูุง .. ูุนูู

2.5 \* 22000 = 55000 Terabyte = 5.5 Peta byte

โซ ู ุฏูููุชู ูู ุฑุฌุนูุง ุงู ูู ููู ุจูุจูู ุนูุฏูุง 2.5 Terabyte ูู ุงูุฏุงุชุง ู ุงุญูุง ูุญุชุงุฌูู bandwidth 2.5T.B./24*60*60

2500,000 MB / 86400 = 30 M.B./second

โซ ุฑุงูุญ ุฌู ุชูุงู .. ูุฎุด ุจูู ู ุงูrequirements ุงุฒุงู ูุญูููุง User flow ููุทุฉ ุญููุฉ ูุจุชุฏู ูููุง ูู ุงู

![ูุฎุด ูู ุงูููุถูุน ุนูู ุทูู - YouTube](https://i.ytimg.com/vi/UfVHrtPEjvk/hqdefault.jpg align="left")

โซ ุฏู ุดูู ูุจุณุท high level ุจุนุฏูู ุญูุชุนูู ููู

1.  Sender sends a message to receiver through the server
    
2.  Server acknowledges that it received the message
    
3.  Server forwards the message to receiver.
    
4.  Async call/Another thread writes the message to the database.
    
5.  Receiver acknowledges the receiving of the message to the server.
    
6.  Server notifies sender that receiver saw the message
    

โซ ุฏูููุชู ูุญุชุงุฌูู ูุนุฑู ุงุฒุงู ููุงูู ุทุฑููุฉ ุญููุฉ ุนุดุงู ุงูusers ูุจุนุชูุง ู ูุชุณูุจููุง ุฑุณุงูู ู ูุชุงูุตููุง ูุน ุงูserver

โซ ูก- Pull model: ู ุฏู ุนุงูู ุฒู ูููุฏู ููุง ูุงุนุฏ ูููู ุจุงุดุง

โซ ูข- Push model ุงูclient ุจูุจุนุช ููุณูุฑูุฑ ูุณุฃูู ูู ููู ุญุงุฌุฉ ุฌุงุชูู ู ูุณูุจ ุงูconnection ููุชูุญ .. ู ูุนูุฏูุด ูุดุงูู ุงู ุงูุณูุฑูุฑ ููุฑุฏุด ุนููู ุจุณุฑุนุฉ .. ู ุทุจุนุง ูู ุงูconnection timeout ุจูุนูู retry

โซ ุงูุญู ุงูุชุงูู ููุงุณุจ ู ุญุงูุชูุง ุนุดุงู ูู ูฅูู ููููู user ูุนุฏูุง ูููููุง ุงูุณูุฑูุฑ ุฏู ูุฏู ูููู ุฌุฏูุง ุฎุตูุตุง ุงูู ุนุดุงู ูุชุฌูุจ latency .. ูุญุชุงุฌูู ุงูclient ููุถู ูุณุฃู ุงูุณูุฑูุฑ ูุชูุฑ ู ูุนุธู ุงูููุช ุญูุฑุฌุนูู empty response ู ุงูุฃูุถู ุงููุง ูุณุชุนูู ุงูุฃูุจุดู ุงูุชุงูู ู ูุณูุจ ุงูุณูุฑูุฑ ูุจุนุชููุง ูููู ูุง ุญุงุฌุฉ ุชุฌูููุง ุทูุจ ุฏูููุชู ุงูุณูุฑูุฑ ุญูุนุฑู ูููู ุงููู user ูุณุชูู ุงููู message ุ

โซ ูููู ุจ ุฏุงุชุง ุจูุฒ ุช map ุงูUser Id ุจุงููุณุฌ ุจุงูconnection object ุทุจ ู ูุนุฑู ูููู ุงู ุงูููุฒุฑ ุจูู ุฃูููุงูู ููุง ุจููุฎููุง ูุน ุญุฏ ุชุงูู ุ

โซ ุฃูู ูุง ุงูpush model ูุจุชุฏู ู ุงูuser ูุณุฃู ุงูุณูุฑูุฑ ูู ุญุฏ ุจุนุชูู ุญุงุฌุฉ ูููู ุงูุณูุฑูุฑ ูุฌุฑุณู ู ูุจุนุช ููfriend list ุงูู ููุฌูุฏ .. ูููู ู optimise ุงููุง ูุจูู ุงูู ุฃูููุงูู ูุฃูุชุฑ ูุงุณ ูู ุจูููููู ุนุดุงู ุฏูู ุงููู ููุชููู ุจูู ุจูุง ุงู ุญูุจูู ุนูุฏูุง write operations ูุชูุฑุฉ ูุญุช .. ู ุงูุฏุงุชุง ุตุบูุฑ (ุงููุณุฌ ุจุชุงุนุฉ ุงูุชุดุงุช) .. ู ููููุนุด ูุณุชุนูู databse row based ุนุดุงู ุฏู ุฎุฑุงุจ latency .. ูููู ูุณุชุนูู column based database ุฒู Casandra ุงู HBase .. ู ุญูุณุชููุฏ ุงููู NoSql ู ุญู scaleู ูุนุงูุง ุจุณูููุฉ ุฒุงุฆุฏ ุงู ููุง ูุญุจ ูุนูู read operations .. ุฏู ุงูuser ุญุงูrequest it ุจุงูpagination .. ููุง ุจู scroll ู ุงูุชุดุงุช ูุฏู.

โซ ูุงุถู ุงููุง ูุนูู data partitioning ุนุดุงู ููุจูุงุด ุงูุจูุถ ููู ู ุณูุฉ ูุงุญุฏุฉ .. ูููู ูุนููู ุนูู ุฃุณุงุณ ุงูUserId ุจุญูุซ ุงู ูู ุนูุฏูุง data ุจุญุฌู 5.5 Petabytes ู ุงูdatabase shard ูุณุชุญูู 5 TB ู ูุฏู ุญูุญุชุงุฌ ุญูุงูู ูกูขูู shard .. ู ูููู ูุนุฑู ููุงู ุงูshard ุจุชุงุน ุงูUser ุจ hash(UserID) % 1000

โซ ุญูุญุชุงุฌ ู cache ุขุฎุฑ ูขู ุฑุณุงูุฉ ููููุฒุฑ ุนุดุงู ููุง ุงููุฑุงุด ุชุจุนุชููุง ุฑุณุงูุฉ .. ุญููุถู ููุฑุงูุง ู ูุจุญูู ูููุง ู ูุญุชุงุฌูู ู access it ุจุณุฑุนุฉ.

โซ ูููู ุญูุฎุฒู ุขุฎุฑ ูกู ุฑุณุงูู ููู user ูุนูู ุญูุญุชุงุฌ 20% ูู ุงู storage ูุจูู cached

โซ ุฒุงุฆุฏ ุงููุง ุญูุญุชุงุฌ Load balancer ูู ุงูuser ูู application ู ูู ุงูuser ููcache ู ูู ุงูapplication ูู database ุนุดุงู ุงูtraffic ุงููุจูุฑ .. ุจุณ ุญูุญุชุงุฌ balancing algorithm ุจุญูุซ ุงููุง ุชforward ุงูusers ุงููู ุจูุชููููุง ูุชูุฑ ูservers ุจ capability ุญููุฉ .. ูููู weighted round robin ุฃู Least Connection Method ุนุดุงู ุชุฑูุญ ููุณูููุฑ ุงููู ูุงุถู .. ุนูุจ ุงูุทุฑููุฉ ุงูุชุงููุฉ ุงู ุงูload balancer ูุญุชุงุฌ ูุดูู ุงูุฃูู ุงูinfo ุจุชุงุนุฉ ุงูserver ูุจู ูุง ู forward ุงูุฑููููุณุช ู ุจุณ ูุง ุญุจุงูุจู .. ุฃุชููู ุชููููุง ุงุณุชูุชุนุชูุง ู ุฃุชููู ุฃููู ุฃูุฏุชูู ๐