---
title: "The Two Generals Problem"
datePublished: Sun May 07 2023 13:43:39 GMT+0000 (Coordinated Universal Time)
cuid: clhdgspyz000309l8bbth1gnb
slug: the-two-generals-problem
tags: distributed-system, system-design

---

# ุงูููุฏูุฉโซ

ูู ุณุจุชูุจุฑ 2018 ูุงู ููู ูุดููุฉ ุนูุฏ Delivroo ุงู ูุงุณ ุจุงููุจู ูู ุจุฑูุทุงููุง ูุงู ุจูุฌููุง ููุณ ุงูุฃูุฑุฏุฑ ูุฑุชูู 3 ู ุจูุชู ุฎุตู ุงูุชูู ูููู ูุฐุง ูุฑุฉ .. ุฏู ูุงูุช ูุตูุจุฉ ู ุงูcustomer support ูุงู ุทุงูุน ุนููู ูู ูุชุฑ ุงูุดูุงูู ู ุงูุทูุงุฑูู ูุงููุง ุชุนุจุงููู ูู ูุชุฑ ุงูุชูุตูู .. ุฏู ุจุณุจุจ The 2 Generals Problem

![Finematics](https://cdn.hashnode.com/res/hashnode/image/upload/v1683466594655/7663c52e-d981-4fc2-8a88-e1445729b461.png align="center")

## The Two Generals Problem

โซ ูู ููู ุฌูุดูู ุนุงูุฒูู ูุญุชููุง ููุนุฉ .. ุงููุงุฆุฏ ุจุชุงุน ูู ุฌูุด ุญูุญุจ ููุณู ูุน ุงูุชุงูู ุนุดุงู ููุงุฌููุง ุงูููุนุฉ ูุน ุจุนุถ ูู ููุณ ุงูููุช ูุฃู ูู ุฌูุด ูุงุฌู ููุญุฏู ุญูููุช ู ุงูุฃุญุณู ููุงุฌููุง ุณูุง ุงูููุฑุฉ ุงู ูู ูุงุญุฏ ูููู ุนูู ุฌูุจ ู ุญูุจุนุชูุง ูุจุนุถ ุฑุณุงูู ูุชูููุง ุนูู ูุนุงุฏ ุงููุฌูู

ููุง ุงููุงุฆุฏ ุงูุฃููุงูู ูุจุนุช ููุชุงูู .. ุญูุจูู ุนุงูุฒ ุฑุณุงูุฉ ูู ุงูุชุงูู ููููู ุงูู ุชูุงู ูุนุงุฏ ุงููุฌูู ุงู ูุด ุชูุงู. ููู ูุดููุฉ ููุงู ุงู ูููู ุฑุณุงูุฉ ุงููุงุฆุฏ ุงูุฃููุงูู ุชุถูุน ู ุงููุงุฆุฏ ุงูุชุงูู ููุตูุชููุด ุฃู ุฑุณุงูุฉ ุฃู ูููู ุงููุงุฆุฏ ุงูุชุงูู ุชูุตููู ุงูุฑุณุงูุฉ ุจุณ ุฑุณุงูุฉ ุงูุชุฃููุฏ ุชุถูุน ูู ุงููุต

![Distributed Systems University of Cambridge Computer Science Tripos, Part IB Michaelmas term 2021/22](https://cdn.hashnode.com/res/hashnode/image/upload/v1683466687818/c38b60e6-617e-4794-aeb9-47bfc7a426b0.png align="center")

โซ ูููู ูุญู ูุดุงูู ุงูุชูุณูู ุงู ุงููุงุฆุฏ ุงูุชุงูู ุจุนุฏ ูุง ูุจุนุช ุฑุณุงูุฉ ุงูุชุฃููุฏ .. ูุณุชูู ูู ุงููุงุฆุฏ ุงูุฃููุงูู ูุจุนุชูู ุฑุณุงูุฉ ุจูุฃูุฏูู ุงูู ูุตูุชูู ุฑุณุงูุฉ ุงูุชุฃููุฏ ๐ ุจุณ ูููู ุฑุณุงูุฉ ุงูุชุฃููุฏ ุชุถูุน ุจุฑุถู ู ููุฐุง .. ุฏู ูุดููุฉ ูู ุงูDistributed Systems ุฅุณููุง

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1683466722086/ed12533c-8000-4806-ac1b-081971351122.png align="center")

## ูุซุงู

โซ ุงูููุถูุน ุฏู ููุฏุฑ ูุดููู ูู ุฃุจูููุงุดู ุฒู Talabat ุฃู ุฃูุงุฒูู .. ุงูู ููุง ุจุชุทูุจ ุฃูุฑุฏุฑ ู ุญุชุฏูุน ุฃูููุงูู .. ุงูpayment ุจูููู ุนูู ุณูุฑูุฑ ุชุงูู ู ุบุงูุจูุง ุจุชุจูู service ุชุงููุฉ ุจุชูุฏููููู ุฒู Paypal, Stripe .. ู Talabat ูุญุชุงุฌ ููุณู ูุน Stripe ุงู ุงููุทุนู ุฏู ููุชูุญ ู ุงู ููู ุฃูู ู ููู ุทูุงุฑูู ููุฏุฑูุง ูุฑูุญููู

โซ ู Stripe ุจูุชูุงุตู ูุน ุงูุจูู - ูุดูู ูู ุนูุฏู ูููุณ ุชููู ุฃูุฑุฏุฑ ูู ุงูุทุงุฒุฌ ุทุงูุจู ุงูุณุงุนุฉ 2 ุงููุฌุฑ - ู ูุณุญุจ ุงููููุณ ูู ุงูุญุณุงุจ ู ูุชูุงุตู ูุน Talabat ููููู ุชูุงู ู ุงุจุนุช ุงูุฃูุฑุฏุฑ. ูุงุฒู Talabat ููุณู ูุน Stripe ุจุญูุซ ูู ุงููุทุนู ูุนููุฏูุด ุฃูู ู ููููุนุด ูุณุญุจ ูููุณ ูู ุงูุฒุจูู

![Distributed Systems University of Cambridge Computer Science Tripos, Part IB Michaelmas term 2021/22](https://cdn.hashnode.com/res/hashnode/image/upload/v1683466757470/dea92371-f710-4ee9-9700-2fc199ac2bad.png align="left")

### ุณููุงุฑูููุงุช

โซ ุฏู ู ุงูTwo Generals Problem ุนุงูู ุฒู ุงููุงุฆุฏูู ููุชูููุด ุนุงููุฌูู ูู Talabat ุจุนุชุช ุงูุฃูุฑุฏุฑ ููุบูุฑ ูุง Stripe ูุฃูุฏ ุงูู ุณุญุจ ูููุณ ูู ุงูุฒุจูู ู ูุฏู Talabat ุญุชุฎุณุฑ ูููุณ ุฏู ุฒู ูุง ูุงุฆุฏ ููุงุฌู ุนุงูููุนุฉ ููุบูุฑ ูุง ุงููุงุฆุฏ ุงูุชุงูู ูุฃูุฏ ุงูู ุชูุงู ุนุงููุฌูู

โซ ู ูู Stripe ุจุนุชุช ูTalabat ุงูู ุชูุงู ุณุญุจ ุงููููุณ ูู ุงูุฒุจูู ุจุณ Talabat ููุตูููุด ุงูุชุฃููุฏ ู ูุฏู ุงููููุณ ุงุชุณุญุจุช ู ุญุถุฑุชู ูุณู ุฌุนุงูุฉ #hangry ุฏู ูู ุงููุงุฆุฏ ุงูุชุงูู ูุงู ููุฃููุงูู ุชูุงู ููุง ููุงุฌู ููู ุงูุฃููุงูู ููุตูููุด ู ูุฏู ุงููุงุฆุฏ ุงูุชุงูู ุญููุงุฌู ุงูููุนุฉ ููุบูุฑ ุงูุฃููุงูู

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1683466777263/46a63b09-e290-4630-9136-024e945d4d5e.png align="center")

โซ ุขุฎุฑ ุณููุงุฑูู ู ูู ุงูุณููุงุฑูู ุงูุฌููู ุงู ูู Talabat ุชูุงุตูุช ูุน Stripe ู Stripe ุณุญุจุช ุงููููุณ ู ุจุนุชุช ูTalabat ู Talabat ุจุนุชุช ุงูุฃูุฑุฏุฑ

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1683466841963/fc7d0ad2-9276-4f71-a088-2df7e849369f.png align="center")

## Idempotent token

โซ ุญู ูุดููุฉ ุงู2 Generals ูู ุจุฅุณุชุนูุงู ุญุงุฌุฉ ุงุณููุง Idempotent Key ุงู Idempotent token Idempotency ูู ูุจุฏุฃ ูู ุงูAPI communication ุงู ูู ุจุนุช ุฑูููุณุช ููุณูุฑูุฑ 500 ูุฑุฉ ุจููุณ ุงูarguments ู ูุงุฒู ูุฑุฏ ุนููู ููุณ ุงูุฑุฏ ูู ุงูุช ุจุนุช ุฑูููุณุช ูุฑุฉ ูุงุญุฏุฉ

โซ ู ุฏู ุงููุดููุฉ ุงููู ูุงูุช ุนูุฏ Delivroo .. ููุง ุงููุงุณ ูุงูุช ุจุชุจุนุช ุฑูููุณุช ู ุชุนูู ุฃูุฑุฏุฑ .. ูุงู ููู ูุดููุฉ ุชูุงุตู ุจูู ุงูPayment Gateway ู ุจูู Delivroo ุนุดุงู ุงูpayment ุจูุณุญุจ ูููุณ ูู ุงูุฒุจุงูู ู Delivroo ูุจููุตูููุด Ack ูู ุงูpayment ู ุจูtime out ู ูููููู ุฌุฑุจูุง ุชุงูู

โซ ุจุนุฏ ูุง ุจูุฌุฑุจูุง 3 ุฃุฑุจุน ูุฑุงุช ุงูapp ุจูููููู ุชูุงู ู ุงูุฒุจุงูู ุจุชูุชูุฑ ุงููู ุทูุจูุง ูุฑุฉ ูุงุญุฏุฉ. ุญู ุงูููุถูุน ุฏู ุงู ููุง ุงูclient ุงู ุงูapp ูุนูู ุฑูููุณุช ููpayment ู ูุงุฒู ูุญุท Idempotent key ู ุฏู ุนุจุงุฑุฉ ุนู UUID (ุฒู 123e4567-e89b-12d3-a456-426614174000) ู ุจูุจูู ุฌุฒุก ูู ุงูinput arguments ููุฑูููุณุช

โซ ููุง ุงูุฑูููุณุช ูุชุจุนุช ููpayment service, ุงูุฃุฎูุฑ ุจูุจุต ุนูู datastore ุจูุฎุฒู ูู ุงูidempotent tokens ููุชุฑุฉ ุฒูููุฉ ูุนููุฉ ุจุนุฏูู ุจูexpire (ูู ุงูtoken ูุด ููุฌูุฏ) ูู ููุฌูุฏ ู ุจููููู ุงูุฃูุฑุฏุฑ ุฅุชุทูุจ ุฎูุงุต ูููุด ุฏุงุนู ููุชูุฑุงุฑ

![Diagram done using https://excalidraw.com/](https://cdn.hashnode.com/res/hashnode/image/upload/v1683466920295/f836f7ba-0942-43ad-ad13-4fb57a9639a4.png align="center")

# ุงููุตุงุฏุฑ

1. [https://www.cl.cam.ac.uk/teaching/2122/ConcDisSys/dist-sys-notes.pdf](https://www.cl.cam.ac.uk/teaching/2122/ConcDisSys/dist-sys-notes.pdf)
    
2. [https://www.youtube.com/watch?v=MDuWnzVnfpI&t=198&ab\_channel=MartinKleppmann](https://www.youtube.com/watch?v=MDuWnzVnfpI&t=198&ab_channel=MartinKleppmann)
    
3. [https://www.youtube.com/watch?v=I08syTslan8&ab\_channel=BeABetterDev](https://www.youtube.com/watch?v=I08syTslan8&ab_channel=BeABetterDev)
    
4. [https://www.youtube.com/watch?v=IP-rGJKSZ3s&ab\_channel=TomScott](https://www.youtube.com/watch?v=IP-rGJKSZ3s&ab_channel=TomScott)